<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Account Dashboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 bg-light p-3">
            <h4>Account Viewer</h4>
            <div class="btn-group-vertical w-100" role="group">
                <button class="btn btn-primary mb-2" onclick="viewAllAccounts()">View All Accounts</button>
                <button class="btn btn-secondary mb-2" onclick="showFindById()">Find Account by ID</button>
                <button class="btn btn-success mb-2" onclick="showCreateAccount()">Create Account</button>
                <button class="btn btn-info mb-2" onclick="showUpdateById()">Update Account by ID</button>
                <button class="btn btn-danger mb-2" onclick="showDeleteById()">Delete Account by ID</button>
            </div>
        </div>

        <!-- Main Output Area -->
        <div class="col-md-9 p-3" id="output-area">
            <h4>Welcome! Select an option on the left.</h4>
        </div>
    </div>
</div>

<script>
function viewAllAccounts() {
    $.get("/accounts", function(data) {
        if (!Array.isArray(data)) return $('#output-area').html('<p>Error retrieving accounts.</p>');
        let html = '<h4>All Accounts</h4><table class="table"><thead><tr><th>ID</th><th>Name</th><th>Website</th><th>Revenue</th><th>Region</th></tr></thead><tbody>';
        data.forEach(acc => {
            html += `<tr><td>${acc.id}</td><td>${acc.account_name || ''}</td><td>${acc.website || ''}</td><td>${acc.revenue || ''}</td><td>${acc.region || ''}</td></tr>`;
        });
        html += '</tbody></table>';
        $('#output-area').html(html);
    });
}

function showFindById() {
    $('#output-area').html(`
        <h4>Find Account by ID</h4>
        <input id="find-id" type="number" class="form-control mb-2" placeholder="Enter Account ID">
        <button class="btn btn-primary" onclick="findById()">Find</button>
        <div id="result" class="mt-3"></div>
    `);
}

function findById() {
    const id = $('#find-id').val();
    $.get(`/accounts/${id}`, function(acc) {
        const html = `<table class="table"><tr><th>ID</th><th>Name</th><th>Website</th><th>Revenue</th><th>Region</th></tr>
                      <tr><td>${acc.id}</td><td>${acc.account_name}</td><td>${acc.website}</td><td>${acc.revenue}</td><td>${acc.region}</td></tr></table>`;
        $('#result').html(html);
    }).fail(() => $('#result').html('<div class="text-danger">Account not found.</div>'));
}

function showUpdateById() {
    $('#output-area').html(`
        <h4>Update Account by ID</h4>
        <input id="update-id" type="number" class="form-control mb-2" placeholder="ID">
        <input id="update-name" type="text" class="form-control mb-2" placeholder="Account Name">
        <input id="update-website" type="text" class="form-control mb-2" placeholder="Website">
        <input id="update-revenue" type="text" class="form-control mb-2" placeholder="Revenue">
        <input id="update-region" type="text" class="form-control mb-2" placeholder="Region">
        <button class="btn btn-info" onclick="updateById()">Update</button>
        <div id="update-result" class="mt-3"></div>
    `);
}

function updateById() {
    const id = $('#update-id').val();
    const payload = {
        account_name: $('#update-name').val(),
        website: $('#update-website').val(),
        revenue: $('#update-revenue').val(),
        region: $('#update-region').val()
    };
    $.ajax({
        url: `/accounts/${id}`,
        method: 'PUT',
        data: JSON.stringify(payload),
        contentType: 'application/json',
        success: res => $('#update-result').html(`<div class="text-success">Account updated successfully.</div>`),
        error: err => $('#update-result').html(`<div class="text-danger">Failed to update. Check if ID exists.</div>`)
    });
}

function showDeleteById() {
    $('#output-area').html(`
        <h4>Delete Account by ID</h4>
        <input id="delete-id" type="number" class="form-control mb-2" placeholder="Enter ID to delete">
        <button class="btn btn-danger" onclick="deleteById()">Delete</button>
        <div id="delete-result" class="mt-3"></div>
    `);
}

function deleteById() {
    const id = $('#delete-id').val();
    $.ajax({
        url: `/accounts/${id}`,
        method: 'DELETE',
        success: res => $('#delete-result').html(`<div class="text-success">Account deleted.</div>`),
        error: err => $('#delete-result').html(`<div class="text-danger">Delete failed. ID not found.</div>`)
    });
}

function showCreateAccount() {
    $('#output-area').html(`
        <h4>Create Account</h4>
        <input id="create-name" type="text" class="form-control mb-2" placeholder="Account Name">
        <input id="create-website" type="text" class="form-control mb-2" placeholder="Website">
        <input id="create-revenue" type="text" class="form-control mb-2" placeholder="Revenue">
        <input id="create-region" type="text" class="form-control mb-2" placeholder="Region">
        <button class="btn btn-success" onclick="createAccount()">Create</button>
        <div id="create-result" class="mt-3"></div>
    `);
}

function createAccount() {
    const payload = {
        account_name: $('#create-name').val(),
        website: $('#create-website').val(),
        revenue: $('#create-revenue').val(),
        region: $('#create-region').val()
    };
    $.ajax({
        url: '/accounts',
        method: 'POST',
        data: JSON.stringify(payload),
        contentType: 'application/json',
        success: res => $('#create-result').html(`<div class="text-success">Account created. ID: ${res.id}</div>`),
        error: err => $('#create-result').html(`<div class="text-danger">Creation failed.</div>`)
    });
}
</script>
</body>
</html>
