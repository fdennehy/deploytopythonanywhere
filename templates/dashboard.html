<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Account & Contact Dashboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <style>
        /* Keep left sidebar scrollable with fixed height */
        .sidebar-section {
            margin-bottom: 30px;
        }
        .btn-group-vertical.w-100 > button {
            min-width: 160px;
        }
        /* Fixed height and scroll for tables */
        #output-area table {
            max-height: 400px;
            overflow-y: auto;
            display: block;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 bg-light p-3" style="height: 100vh; overflow-y: auto;">
            <div class="sidebar-section">
                <h4>Account Viewer</h4>
                <div class="btn-group-vertical w-100" role="group">
                    <button class="btn btn-primary mb-2" onclick="viewAllAccounts()">View All Accounts</button>
                    <button class="btn btn-secondary mb-2" onclick="showFindAccountById()">Find Account by ID</button>
                    <button class="btn btn-success mb-2" onclick="showCreateAccount()">Create Account</button>
                    <button class="btn btn-info mb-2" onclick="showUpdateAccountById()">Update Account by ID</button>
                    <button class="btn btn-danger mb-2" onclick="showDeleteAccountById()">Delete Account by ID</button>
                </div>
            </div>

            <div class="sidebar-section">
                <h4>Contact Viewer</h4>
                <div class="btn-group-vertical w-100" role="group">
                    <button class="btn btn-primary mb-2" onclick="viewAllContacts()">View All Contacts</button>
                    <button class="btn btn-secondary mb-2" onclick="showFindContactById()">Find Contact by ID</button>
                    <button class="btn btn-success mb-2" onclick="showCreateContact()">Create Contact</button>
                    <button class="btn btn-warning mb-2" onclick="showCreateDummyContacts()">Create Dummy Contact(s)</button>
                    <button class="btn btn-info mb-2" onclick="showUpdateContactById()">Update Contact by ID</button>
                    <button class="btn btn-danger mb-2" onclick="showDeleteContactById()">Delete Contact by ID</button>
                </div>
            </div>
        </div>

        <!-- Main Output Area -->
        <div class="col-md-9 p-3" id="output-area">
            <h4>Welcome! Select an option on the left.</h4>
        </div>
    </div>
</div>

<script>
// === Account Viewer Functions ===
function viewAllAccounts() {
    $.get("/accounts", function(data) {
        if (!Array.isArray(data)) return $('#output-area').html('<p>Error retrieving accounts.</p>');
        let html = '<h4>All Accounts</h4><table class="table table-striped table-bordered"><thead><tr><th>ID</th><th>Name</th><th>Website</th><th>Revenue</th><th>Region</th></tr></thead><tbody>';
        data.forEach(acc => {
            html += `<tr><td>${acc.id}</td><td>${acc.name || ''}</td><td>${acc.website || ''}</td><td>${acc.revenue || ''}</td><td>${acc.region || ''}</td></tr>`;
        });
        html += '</tbody></table>';
        $('#output-area').html(html);
    });
}

function showFindAccountById() {
    $('#output-area').html(`
        <h4>Find Account by ID</h4>
        <input id="find-account-id" type="number" class="form-control mb-2" placeholder="Enter Account ID">
        <button class="btn btn-secondary" onclick="findAccountById()">Find</button>
        <div id="account-find-result" class="mt-3"></div>
    `);
}

function findAccountById() {
    const id = $('#find-account-id').val();
    if (!id) return alert('Please enter an Account ID.');
    $.get(`/accounts/${id}`, function(acc) {
        const html = `<table class="table table-bordered"><tr><th>ID</th><th>Name</th><th>Website</th><th>Revenue</th><th>Region</th></tr>
                      <tr><td>${acc.id}</td><td>${acc.name}</td><td>${acc.website}</td><td>${acc.revenue}</td><td>${acc.region}</td></tr></table>`;
        $('#account-find-result').html(html);
    }).fail(() => $('#account-find-result').html('<div class="text-danger">Account not found.</div>'));
}

function showCreateAccount() {
    $('#output-area').html(`
        <h4>Create Account</h4>
        <input id="create-account-name" type="text" class="form-control mb-2" placeholder="Name">
        <input id="create-account-website" type="text" class="form-control mb-2" placeholder="Website">
        <input id="create-account-revenue" type="text" class="form-control mb-2" placeholder="Revenue">
        <input id="create-account-region" type="text" class="form-control mb-2" placeholder="Region">
        <button class="btn btn-success" onclick="createAccount()">Create</button>
        <div id="create-account-result" class="mt-3"></div>
    `);
}

function createAccount() {
    const payload = {
        name: $('#create-account-name').val(),
        website: $('#create-account-website').val(),
        revenue: $('#create-account-revenue').val(),
        region: $('#create-account-region').val()
    };
    $.ajax({
        url: '/accounts',
        method: 'POST',
        data: JSON.stringify(payload),
        contentType: 'application/json',
        success: res => $('#create-account-result').html(`<div class="text-success">Account created. ID: ${res.id}</div>`),
        error: err => $('#create-account-result').html(`<div class="text-danger">Creation failed.</div>`)
    });
}

function showUpdateAccountById() {
    $('#output-area').html(`
        <h4>Update Account by ID</h4>
        <input id="update-account-id" type="number" class="form-control mb-2" placeholder="ID">
        <input id="update-account-name" type="text" class="form-control mb-2" placeholder="Name">
        <input id="update-account-website" type="text" class="form-control mb-2" placeholder="Website">
        <input id="update-account-revenue" type="text" class="form-control mb-2" placeholder="Revenue">
        <input id="update-account-region" type="text" class="form-control mb-2" placeholder="Region">
        <button class="btn btn-info" onclick="updateAccountById()">Update</button>
        <div id="update-account-result" class="mt-3"></div>
    `);
}

function updateAccountById() {
    const id = $('#update-account-id').val();
    if (!id) return alert('Please enter Account ID.');
    const payload = {
        name: $('#update-account-name').val(),
        website: $('#update-account-website').val(),
        revenue: $('#update-account-revenue').val(),
        region: $('#update-account-region').val()
    };
    $.ajax({
        url: `/accounts/${id}`,
        method: 'PUT',
        data: JSON.stringify(payload),
        contentType: 'application/json',
        success: res => $('#update-account-result').html(`<div class="text-success">Account updated successfully.</div>`),
        error: err => $('#update-account-result').html(`<div class="text-danger">Failed to update. Check if ID exists.</div>`)
    });
}

function showDeleteAccountById() {
    $('#output-area').html(`
        <h4>Delete Account by ID</h4>
        <input id="delete-account-id" type="number" class="form-control mb-2" placeholder="Enter ID to delete">
        <button class="btn btn-danger" onclick="deleteAccountById()">Delete</button>
        <div id="delete-account-result" class="mt-3"></div>
    `);
}

function deleteAccountById() {
    const id = $('#delete-account-id').val();
    if (!id) return alert('Please enter Account ID.');
    $.ajax({
        url: `/accounts/${id}`,
        method: 'DELETE',
        success: res => $('#delete-account-result').html(`<div class="text-success">Account deleted.</div>`),
        error: err => $('#delete-account-result').html(`<div class="text-danger">Delete failed. ID not found.</div>`)
    });
}

// === Contact Viewer Functions ===

function viewAllContacts() {
    $.get("/contacts", function(data) {
        if (!Array.isArray(data)) return $('#output-area').html('<p>Error retrieving contacts.</p>');
        let html = '<h4>All Contacts</h4><table class="table table-striped table-bordered"><thead><tr><th>ID</
